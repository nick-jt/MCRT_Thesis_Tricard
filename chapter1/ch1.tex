\addchapheadtotoc

\chapter{Introduction} \label{chapter:Introduction}
Combustion has long been an effective means of energy conversion. Transportation systems, building heating and cooling, and power for electrical grids are just a few examples of its many applications. Over 82\% of energy produced on earth is produced through combustion \cite{2021BpEnergy}. 
At the same time, the explosive nature of the process may also result in its unwanted presence (e.g. rocket explosions, forest fires, house-fires, detonative combustion).
Combustion is therefore a process that both can be used and must be managed. 
Meanwhile the ongoing focus to reduce global emissions also imposes restraints on combustion researchers and scientists. Pollutants such as CO${}_2$, nitrous oxides, and soot have been shown to have a negative influence on our environment.
So while the energy storage and release mechanisms that accompany combustion prove convenient for a lot of systems, they simultaneously presents a challenge for engineers and researchers.
The need for improvement management of thermal loads, greater interconnected transport systems, development of heat-resistant materials, and an ongoing push to reduce global emissions must be met with an enhanced understanding of these physical systems.
This enhanced understanding requires thorough understanding of the complex fluid dynamics, heat transfer, and chemistry that accompany combustion.
Radiation is one of the most prominent physical processes that occurs during... 


\section{Background/Motivation}
Thermal radiation is often the most dominant form of heat transfer that accompanies most combustion systems \cite{Coelho2018RadiativeSystems}. In many cases, radiation presents an undesirable redistribution of thermal energy to surrounding objects.

In forest fires, for example, radiative energy can contribute extensively to the widespread propagation and expansiveness of a flame. 
It may heat nearby combustible materials, dry them substantially, and make the flame considerably more likely to accelerate into that direction. 
Nearby firemen, oftentimes only meters away from the flame, may be exposed to dangerous thermal radiative loads up to 12 kW/m$^2$, which can result in instantaneous burning to any unprotected skin.
In total, the contribution of thermal radiation varies between 10\% and 90\% of the total energy flux from an open flame \cite{Valendik2008EffectEnvironment}.

In aeronautical engines, the high temperatures present from the chemical energy release may emit heavily into the surroundings. Further, unburnt hydrocarbons may agglomerate into soot particles which, at high temperatures, dominate the emission spectrum.
Concomitant high radiative loads will result in higher temperatures in the encasing system, changes in chemistry dynamics such as flame extinction and changes on pollutant emissions, and, thermodynamically, a net energy loss from the system which can no longer contribute to any desired work output.

In its most ideal form, radiative emission energy takes the form of eq. \ref{eq:RadEnergy}.
\begin{equation}
    E_{rad}=\epsilon{}\sigma{}T^4
    \label{eq:RadEnergy}
\end{equation}
Where E$_{rad}$ is the radiative emissive power in W/m$^3$, $\epsilon{}$ is the dimensionless emissivity (or emittance), $\sigma{}$ is the Stefan-Boltzmann constant in W/m$^2$K$^4$, and T is the temperature in Kelvin. 
The fourth power relationship of emissive power with temperature represents why radiation is often more prominent in combustion, where temperatures can reach upwards of $2000$ K \cite{Modest2016RadiativeSystems}.

Within combustion in particular, radiation becomes important for pollutant formation, flame speeds, and threshold phenomena (near-limits) \cite{Modest2016RadiativeSystems,Coelho2018RadiativeSystems,Liu2020TheFlames}. Including radiation can have an effect on the fluid dynamics, turbulence, boundaries, and mixture properties of a combustion simulation.

Many turbulent flows are modeled using Reynolds-Averaged Navier-Stokes (RANS) and Large Eddy Simulations (LES), both of which rely on the averaging of the governing equations of combustion. This results in the need for models describing the unresolved fluctuations of radiative properties. The influence of unresolved scales on radiation is known as turbulence-radiation interaction (TRI). Emission-TRI and absorption-TRI are two radiative phenomena which can complicate radiation modeling, and have been extensively studied.

Regarding modeling radiation in reacting flows, several trends are broadly observed, as discussed in reviews from Modest and Haworth \cite{Modest2016RadiativeSystems}, Coehlo \cite{Coelho2018RadiativeSystems}, and Liu et. al. \cite{Liu2020TheFlames}.

\begin{enumerate}
    \item Neglecting radiative emission results in temperature overprediction \cite{Gamil2020AssessmentChamber}
    \item Neglecting radiative absorption (optically thin assumption) results in temperature underestimation
    \item Radiation contributes thermal energy at the same order of magnitude as convection to the boundaries of many enclosed combustion systems \cite{Gamil2020AssessmentChamber,Johnson2021AnalysisMethod}
    \item Radiation has importance in pollutant formations (NO${}_x$, soot, CO) \cite{Ihme2008ModelingFormulation,Habibi2007TurbulenceFlames}
    \item Accounting for turbulence-radiation interaction (TRI) increases radiative emission and reduces temperatures
    \item Soot dominates the emission and absorption spectra
    \item Nongray modeling increases radiation re-absorption in the medium\cite{Wu2021LimitationsFires}
    \item The type of radiation model yields less importance than accurate non-gray modeling
\end{enumerate}

Evidently, radiation plays an important role in many reacting flow configurations including gas-turbine engines, open-flames, and rocket engines.
As a result, neglecting radiation is a common source of error for combustion scientists and engineers. 
This provides a rationalization for the effort to produce faster and more accurate radiation models.

\section{Modeling challenge and approach}
The immense computational expense required for integration of the multitude of coupled equations within a combustion simulation are infeasible even with modern computing resources. Oftentimes, thermal radiation is either ignored or modeled using oversimplified approaches because it adds significantly to this expense.

In attempt to maximize accuracy at the limitations of present resources, a number of models have been introduced to model thermal radiation while minimizing computational burden.
Of those, many rely on complex mathematical assumptions and simplifications which can be difficult to learn, implement, and may lead to inaccurate results for an unfamiliar user. 


The Monte-Carlo Ray Tracing (MCRT) method stands out as the most accurate, robust, and conceptually simple of the available models \cite{Tesse2002RadiativeApproach,Modest2013RadiativeTransfer,Coelho2018RadiativeSystems}, and is believed by many to be the best radiation model as computational power increases \cite{Howell2010ThermalTransfer}.
MCRT can be thought of as a rough physical interpretation of the process by which electromagnetic rays are transported through space.
Within MCRT, random rays are initiated within the computational cells of the combustion simulation, and are tasked with redistributing the energy originating from it's source cell to other computational cells throughout the medium. The resulting stochastic process intuitively resembles the redistribution of thermal energy through 'photon packets' traveling through the domain.
As a result of this approach, MCRT can account for many of the same effects that electromagnetic rays undergo during their travel.

Although MCRT is the most accurate, it has also been viewed traditionally as the most computationally expensive.
This additional cost results from the stochastic nature of MCRT. A large sample size of rays must be emitted and traced to obtain a statistically meaningful solution. 
Too few rays may result in a noisy solution, while too many will require a longer runtime.
Much effort has been put into making the computation more manageable while maintaining the benefits MCRT has to offer over other methods \cite{Liu2020TheFlames,Tesse2002RadiativeApproach,Zeeb2001AnGeometries,Modest2003BackwardTransfer,Howell2010ThermalTransfer}.

Additionally many radiation solutions can be dramatically accelerated through a \textit{frozen-field analysis}. In frozen-field analysis it is assumed that the time required for a given ray to propagate across the domain is extremely small relative to even the shortest computational time-steps. 
As a result, the temporal evolution of parameters in the system can be assumed negligible during a ray's travel.
This greatly simplifies the solution to the radiative transfer equation (eq. \ref{eq:RTE2}, which is already presented with temporal-evolution neglected), as it can now be modeled at any given time-step of the CFD solution, while assuming the radiation solution can be calculated using a single timestep.

In this paper, we implement an accelerated implementation of MCRT that is coupled with the OpenFOAM open-sourced CFD platform \cite{Weller1998ATechniques}. 
This implementation relies on Kokkos programming model for performance-portable parallel computing with interchangeable parallel computing back-ends \cite{Trott2021KokkosEra}. This enables the use of Graphics Processing Units (GPUs) to dramatically accelerate the ray-tracing procedure, a process has been done very few times, but has shown significant speedups \cite{Silvestri2019ASimulation,Humphrey2016RadiativeRefinement,Heymann2012GPU-basedAGN}. 
Additionally, the ArborX geometric search library is introduced to implement a bounding-volume hierarchy based structure which has shown efficiency boosts in the field of graphics processing \cite{Lebrun-Grandie2019ArborX:Library}. 

\section{Organization}
This thesis will first present background on the importance on radiation and its importance in combustion in chapter \ref{chapter:Importance}. 
Following the description of the reasons, various methods of modeling radiation will be presented in chapter \ref{chapter:Modeling}. Included in this chapter will be the description of a Monte-Carlo approach that provides massive speedup on high performance computers (HPCs) using multiple layers of computing parallelism including Message Passing Interface (MPI) and Graphics Processing Units (GPUs).
Chapter \ref{chapter:Example} will provide a demonstration of the model on both canonical and practical configurations. Thorough analysis of radiation importance, the effect of various models, and computational speedup will be presented in this chapter.
Finally, conclusions and future work will be discussed in chapter \ref{chapter:conclusion}.