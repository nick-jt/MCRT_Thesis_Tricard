\addchapheadtotoc
\chapter{Conclusions and future work}~\label{chapter:conclusion}

\section{Summary of findings}
The influences of thermal radiation are known to be significant in combustion systems. A brief overview of the fundamentals of radiation, as well as categorized effects of radiation in combustion specifically, were discussed in chapter \ref{chapter:Importance}. 
Radiation has been shown to contribute significantly to changes in the turbulence, boundary interactions, and chemical characteristics in and around the flame.

TODO

The introduction of radiation in the modeling procedure will generally reduce temperatures of combustion processes. 
Additionally, it has been shown that the modeling of fire hazards, power generation devices, and many more applications require adequate modeling of radiation. 

The background of the Monte-Carlo method of modeling radiation was next discussed in chapter~\ref{chapter:Modeling}. The Monte-Carlo method is broadly known to be the most accurate, robust, but also most computationally expensive radiation model used.
With computational power increasing, however, it has been known to be the likely choice of the future. First an account of the fundamentals of MCRT, including the random number relations of point of emission, direction and wavenumber of the rays, was discussed.
A description of the tracing procedure through the mesh, and to the boundaries was also provided.
Several alternative mathematical techniques, as well as re-formulations of the Radiative Transfer Equation (RTE) were presented, along with their various advantages. Recent work has shown exciting progress, including the advent of the null-collision technique. Next, various influences of ray-tracing from the field of computer graphics were presented, including the Graphics Processing Unit (GPU) and Bounding Volume Hierarchy (BVH).
Previous literature was reviewed on applications of these methods, and it was found that relatively few researchers had applied GPUs to MCRT, but had observed tremendous runtime reductions, and almost no other researchers had applied the BVH to the calculation of a participating medium.
Finally, description of the radiation implementation for this research was presented, where both GPUs and BVHs were applied, as well as the highest fidelity non-gray model, line-by-line, and a robust tracing procedure through an unstructured polyhedral mesh.
The model was integrated with the \verb|OpenFOAM| CFD software package, which enabled its use with coupled, time-accurate combustion simulations through a source term contribution to the energy equation. Additionally, the Kokkos programming model and ArborX geometric search library were used for performance portability and BVH implementation, respectively.

The present model was applied to four geometries of varying complexity: a plane-parallel participating medium, a vitiated backward-facing step combustor, a turbulent time-accurate pool-fire, and a sooting Pratt \& Whitney combustor geometry.
First, the 1-D results showed excellent agreement with analytical solutions. Comparisons of the radiative absorption under a variety of absorption coefficients, medium temperatures, and ray counts showed expected results. Radiative absorption increased with absorption coefficient and temperature, and stochastic variability became more apparent with lower ray-counts.
Then, a 3-D backward-facing step combustor was simulated at a moderate temperature of approximately $800$K. Results were compared against those of an established Fortran-radiation model. Excellent agreement was found, further validating the new MCRT code. It was found that a runtime reduction of $60$\% was seen between the established Fortran implementation compared to the newer MCRT, and GPU parallel processing further reduced runtimes by approximately $25$\%. The speedups were a result of two advancements: improvements in parallel implementation through the introduction of the Kokkos back-end, and improved memory management through minimal duplication of mesh-data within the CPU.
Next, the 3-D pool-fire flame proved an excellent tool to demonstrate the use of the new MCRT model. First, a frozen-field analysis was conducted on an early timestep of the simulation. Results showed a strong redistribution of energy throughout the flame and to the surrounding walls. Trends between radiative absorption and emission with the Planck-mean absorption coefficient and flame temperature were outlined. A minimal degree of radiative absorption was seen in the surrounding medium. Additionally, the radiative re-absorption in the flame increased considerably when the line-by-line non-gray model was implemented. Detailed account of runtime consumption in the model was described through the use of a profiling tool. It was found that a significant portion of the runtime was consumed through the loading and transferal of the non-gray database. These results were magnified for the GPU, where a deep copy must be performed.
The same configuration was then run from initial conditions in a time-accurate simulation. Physical interpretability of these results were expected to be more accurate because correct influences of radiation can only be accounted for by simulating from initial conditions. Results showed a significant decrease in temperature of up to $600$K compared to the simulation without radiation. Profiling results displayed a consistent $25$\% of the runtime was consumed by radiation for each time-step, on average. Noting the results from the profiling of the frozen-field analysis, it was concluded that the consumption in runtime would decrease if the radiation database is maintained in memory between time-steps.
Finally, succesful validation of the present radiation model encouraged the modeling of a Pratt \& Whitney NEO combustor with line-by-line accurate non-gray modeling. A scatter diagram of various computational parameters in the medium revealed soot exerted a controlling influence on the radiation emission characteristics in the flame. At temperatures beyond a crossover point, soot volume fractions diminished rapidly, resulting in an equally rapid decrease in radiative emission, leading to a local maximum in radiative emission as a function of temperature. The boundaries of the combustor displayed a much higher degree of radiative heat flux adjacent to the fuel-rich region of the combustor. The influence of non-gray modeling was then presented. The line-by-line non-gray model as shown to increase radiative re-absorption significantly and decrease wall-incident radiative heat flux by up to $60$\%. The contributions of various chemical species to the wall-incident heat flux was evaluated, and it was found that soot contributed the most, followed by CO$_2$. 
Profiling of the radiation model on the combustor showed a reduction of runtime by approximately 75\%, and the non-gray calculation increased runtimes by 10\%.

\section{Recommendations for Future Work}
The present implementation of MCRT showed significant speedup compared to the established code. However, it is anticipated that further speedups can be obtained by implementing improved GPU-favorable memory and execution coherence \cite{Silvestri2019ASimulation}, and through the introduction of accelerated distributed memory approaches \cite{Humphrey2015ATracing}. A fully asynchronous computation of radiation and CFD on the GPU and CPU simultaneously would significantly reduce the apparent runtime of radiation. Furthermore, the potential for the Bounding Volume Hierarchy was limited in the present demonstration, however, the BVH may have potential to provide improvements for a distributed-memory simulation. Specifically, the tracing of a ray may proceed simultaneously within multiple GPUs at once through an all-at-once all to all communication of radiation. This implementation of the BVH will be explored in future studies.
Additionally, the potential for the described advanced Monte-Carlo reformulations have been shown to improve runtimes, and may carry significant advantages computationally. Implementations into the current model would likely lead to further performance improvements. Finally, the potential for the null-collision MC technique has only recently been revealed, and it may therefore have significant potential for the acceleration of MCRT. Combining this method with advanced mesh approaches, such as the BVH, could bring measurable speedups to the ray-tracing calculation.
These improvements would enable scientists and engineers to have more complete understanding of the influence of radiation within their combustion systems. 